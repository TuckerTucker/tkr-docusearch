<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="DocuSearch - Processing Status Dashboard">
  <title>DocuSearch - Processing Status</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="app-header">
      <div class="header-content">
        <div class="header-left">
          <h1 class="app-title">DocuSearch</h1>
          <p class="app-subtitle">Monitor document processing status</p>
        </div>
        <div class="header-right">
          <nav class="app-nav" role="navigation" aria-label="Main navigation">
            <a href="index.html" class="nav-link">Upload</a>
            <a href="search.html" class="nav-link">Search</a>
            <a href="status_dashboard.html" class="nav-link nav-link--active" aria-current="page">Status</a>
          </nav>
          <div id="worker-status" class="worker-status">
            <span class="status-indicator status-indicator--checking"></span>
            <span class="status-text">Checking worker...</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="app-main" role="main">
    <h2>Processing Status Dashboard</h2>

    <!-- Queue statistics -->
    <section class="queue-stats">
      <div class="stat-card">
        <h3 class="stat-card-title">Queue Size</h3>
        <span id="queue-size" class="stat-value">-</span>
        <p class="stat-description">Documents waiting</p>
      </div>

      <div class="stat-card">
        <h3 class="stat-card-title">Processing</h3>
        <span id="processing-count" class="stat-value">-</span>
        <p class="stat-description">Currently active</p>
      </div>

      <div class="stat-card stat-card-success">
        <h3 class="stat-card-title">Completed Today</h3>
        <span id="completed-today" class="stat-value">-</span>
        <p class="stat-description">Successfully processed</p>
      </div>

      <div class="stat-card stat-card-error">
        <h3 class="stat-card-title">Failed Today</h3>
        <span id="failed-today" class="stat-value error">-</span>
        <p class="stat-description">Processing errors</p>
      </div>

      <div class="stat-card">
        <h3 class="stat-card-title">Avg. Time</h3>
        <span id="avg-time" class="stat-value">-</span>
        <p class="stat-description">Per document</p>
      </div>

      <div class="stat-card">
        <h3 class="stat-card-title">Est. Wait</h3>
        <span id="est-wait" class="stat-value">-</span>
        <p class="stat-description">For queue</p>
      </div>
    </section>

    <!-- Current processing -->
    <section class="current-processing">
      <h3>Currently Processing</h3>

      <div id="no-processing" class="no-processing">
        <p>No documents currently being processed</p>
      </div>

      <div id="current-doc" class="processing-item" hidden>
        <div class="processing-header">
          <div class="doc-info">
            <strong id="current-filename" class="current-filename">filename.pdf</strong>
            <span id="current-status" class="current-status">Processing...</span>
          </div>
          <div class="processing-meta">
            <span id="current-elapsed" class="processing-elapsed">Elapsed: 0s</span>
            <span id="current-eta" class="processing-eta">ETA: 0s</span>
          </div>
        </div>

        <div class="progress-container">
          <div class="progress-bar">
            <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
          </div>
          <div class="progress-details">
            <span id="progress-percent" class="progress-percent">0%</span>
            <span id="progress-stage" class="progress-stage">Initializing...</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Recent documents -->
    <section class="recent-documents">
      <h3>Recent Documents</h3>

      <div class="table-container">
        <table id="recent-docs-table" class="data-table">
          <thead>
            <tr>
              <th>Filename</th>
              <th>Status</th>
              <th>Pages</th>
              <th>Processing Time</th>
              <th>Uploaded</th>
            </tr>
          </thead>
          <tbody id="recent-docs-body">
            <tr class="loading-row">
              <td colspan="5" class="loading-cell">Loading status data...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Auto-refresh indicator -->
    <div class="auto-refresh" aria-live="polite" aria-atomic="true">
      <span class="refresh-indicator">‚óè</span>
      <span id="refresh-status">Auto-refresh: Active (every 5s)</span>
      <button id="toggle-refresh" class="btn btn-sm btn-outline">Pause</button>
    </div>
    </main>

    <!-- Footer -->
    <footer class="app-footer">
      <p class="footer-text">
        DocuSearch - AI-powered document search with ColPali
      </p>
    </footer>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container" aria-live="polite" aria-atomic="true">
      <!-- Toast messages inserted here by JavaScript -->
    </div>
  </div>

  <!-- Scripts -->
  <script type="module" src="worker-status.js"></script>
  <script src="status_dashboard.js"></script>
</body>
</html>
