# MyPy Configuration for DocuSearch
# Type checking configuration for Python codebase
#
# MyPy is a static type checker for Python that helps catch type errors
# before runtime. This configuration enables strict type checking while
# providing pragmatic overrides for third-party libraries.
#
# Usage:
#   mypy src/                    # Check all source files
#   mypy src/config/urls.py      # Check specific file
#   mypy --config-file mypy.ini src/
#
# Documentation: https://mypy.readthedocs.io/

[mypy]
# =============================================================================
# Python Version
# =============================================================================
python_version = 3.13

# =============================================================================
# Strict Type Checking (Recommended for new code)
# =============================================================================
# Enable strict mode for comprehensive type checking
strict = True

# Individual strict flags (enabled by strict=True, documented here for clarity)
# All functions must have type annotations
disallow_untyped_defs = True
# Cannot call untyped functions from typed code
disallow_untyped_calls = True
# Function definitions must be complete
disallow_incomplete_defs = True
# Type-check bodies of untyped functions
check_untyped_defs = True
# Require explicit type parameters for generics
disallow_any_generics = True
# Warn about unnecessary type casts
warn_redundant_casts = True
# Warn about unused type: ignore comments
warn_unused_ignores = True
# Warn when returning Any from typed function
warn_return_any = True
# Require explicit __all__ for re-exports
no_implicit_reexport = True
# Prohibit equality checks with incompatible types
strict_equality = True

# =============================================================================
# Additional Warnings
# =============================================================================
# Warn about unused mypy config sections
warn_unused_configs = True
# Warn about unreachable code
warn_unreachable = True

# =============================================================================
# Error Messages
# =============================================================================
# Show error codes in messages (e.g., [arg-type])
show_error_codes = True
# Use colored output for terminal
pretty = True
# Show column numbers in error messages
show_column_numbers = True
# Show context around error
show_error_context = True

# =============================================================================
# Import Discovery
# =============================================================================
# Support PEP 420 namespace packages
namespace_packages = True
# Require explicit package base directories
explicit_package_bases = True

# =============================================================================
# Third-Party Library Overrides
# =============================================================================
# Many third-party libraries don't have type stubs or have incomplete typing.
# We ignore missing imports for these to avoid false positives.

[mypy-torch.*]
ignore_missing_imports = True

[mypy-transformers.*]
ignore_missing_imports = True

[mypy-chromadb.*]
ignore_missing_imports = True

[mypy-PIL.*]
ignore_missing_imports = True

[mypy-pdf2image.*]
ignore_missing_imports = True

[mypy-pypdf.*]
ignore_missing_imports = True

[mypy-docx.*]
ignore_missing_imports = True

[mypy-pptx.*]
ignore_missing_imports = True

[mypy-fastapi.*]
ignore_missing_imports = True

[mypy-uvicorn.*]
ignore_missing_imports = True

[mypy-starlette.*]
ignore_missing_imports = True

[mypy-litellm.*]
ignore_missing_imports = True

[mypy-tiktoken.*]
ignore_missing_imports = True

[mypy-mlx.*]
ignore_missing_imports = True

[mypy-mlx_whisper.*]
ignore_missing_imports = True

[mypy-mutagen.*]
ignore_missing_imports = True

[mypy-pydub.*]
ignore_missing_imports = True

[mypy-pytest.*]
ignore_missing_imports = True

[mypy-pytest_asyncio.*]
ignore_missing_imports = True

[mypy-httpx.*]
ignore_missing_imports = True

[mypy-dotenv.*]
ignore_missing_imports = True

[mypy-markdown.*]
ignore_missing_imports = True

# =============================================================================
# Per-Module Overrides (for gradual typing adoption)
# =============================================================================
# Use these sections to relax strict checking for existing code during migration.
# Remove these as modules are updated with proper type annotations.

# Example: Relax checking for legacy modules during Wave 2 migration
# [mypy-src.legacy.*]
# disallow_untyped_defs = False
# disallow_untyped_calls = False

# =============================================================================
# Quality Improvement Sprint Notes
# =============================================================================
# Wave 1 (Current):
#   - mypy.ini created with strict configuration
#   - Baseline type checking established
#   - Core module has full type coverage
#
# Wave 2 (Planned):
#   - Add type annotations to existing modules
#   - Remove per-module overrides as typing improves
#   - Integrate mypy into CI/CD pipeline
#   - Target: 100% type coverage for new code
